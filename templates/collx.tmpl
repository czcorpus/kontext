#*
Copyright (c) 2003-2009  Pavel Rychly

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; version 2
dated June, 1991.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
*#

#from translation import ugettext as _
#from cmpltmpl.document import document
#extends document

#def title
$_("Collocations")#slurp
#end def

#def custom_save
#set global $new_maxitems = $cmaxitems / $collpage
#filter WebSafe
<li class="separ"><a title="$_("Save Frequency list to a CSV file")" href="savecoll?$q;$globals&amp;saveformat=csv&amp;cattr=$cattr&amp;cfromw=$cfromw&amp;ctow=$ctow&amp;cminfreq=$cminfreq&amp;cminbgr=$cminbgr&amp;cmaxitems=$new_maxitems&amp;cbgrfns=$cbgrfns&amp;csortfn=$csortfn&amp;collpage=$collpage"">CSV</a></li>
<li class="separ"><a title="$_("Save Frequency list to an XLSX file")" href="savecoll?$q;$globals&amp;saveformat=xlsx&amp;cattr=$cattr&amp;cfromw=$cfromw&amp;ctow=$ctow&amp;cminfreq=$cminfreq&amp;cminbgr=$cminbgr&amp;cmaxitems=$new_maxitems&amp;cbgrfns=$cbgrfns&amp;csortfn=$csortfn&amp;collpage=$collpage"">XLSX</a></li>
<li class="separ"><a title="$_("Save Frequency list to an XML file")" href="savecoll?$q;$globals&amp;saveformat=xml&amp;cattr=$cattr&amp;cfromw=$cfromw&amp;ctow=$ctow&amp;cminfreq=$cminfreq&amp;cminbgr=$cminbgr&amp;cmaxitems=$new_maxitems&amp;cbgrfns=$cbgrfns&amp;csortfn=$csortfn&amp;collpage=$collpage"">XML</a></li>
<li class="separ"><a title="$_("Save Frequency list to a TXT file")" href="savecoll?$q;$globals&amp;saveformat=text&amp;cattr=$cattr&amp;cfromw=$cfromw&amp;ctow=$ctow&amp;cminfreq=$cminfreq&amp;cminbgr=$cminbgr&amp;cmaxitems=$new_maxitems&amp;cbgrfns=$cbgrfns&amp;csortfn=$csortfn&amp;collpage=$collpage">TXT</a></li>
<li><a title="$_("Save Frequency list with custom parameters")" href="savecoll_form?$q;$globals&amp;cattr=$cattr&amp;cfromw=$cfromw&amp;ctow=$ctow&amp;cminfreq=$cminfreq&amp;cminbgr=$cminbgr&amp;cmaxitems=$new_maxitems&amp;cbgrfns=$cbgrfns&amp;csortfn=$csortfn&amp;collpage=$collpage">$_("Custom")&#8230;</a></li>
#end filter
#end def


#def main
<section>
    #filter WebSafe
    <h2>$_("Collocation candidates")</h2>
    #block collx_navigation($navid="next")

    #set $allhref = 'collx?%s;%s;cattr=%s;cbgrfns=%s;cminfreq=%s;cminbgr=%s;cfromw=%s;ctow=%s;csortfn=%s' % ($q, $globals, $cattr, $cbgrfns, $cminfreq, $cminbgr, $cfromw, $ctow, $csortfn)
    #if $collpage > 1 or not $lastpage
        <div class="bonito-pagination">
            <form action="collx">
                <fieldset class="float">
                    #if $collpage > 1
                    <div class="bonito-pagination-left">
                        <a href="$allhref"><img class="alt-img" src="../files/img/first-page.png" alt="$_("<< First")" title="$_("<< First")" data-alt-img="../files/img/first-page_s.png" /></a>
                        <a href="$allhref;collpage=$(int($collpage) - 1)"><img class="over-img" src="../files/img/prev-page.png" alt="$_("< Previous")" title="$_("< Previous")" data-alt-img="../files/img/prev-page_s.png" /></a>
                    </div>
                    #end if

                    <div class="bonito-pagination-core">
                        #filter None
                        $input_hidden
                        #end filter
                        <input type="hidden" name="cattr" value='$cattr' />
                        <input type="hidden" name="cbgrfns" value='$cbgrfns' />
                        <input type="hidden" name="cminfreq" value='$cminfreq' />
                        <input type="hidden" name="cminbgr" value='$cminbgr' />
                        <input type="hidden" name="cfromw" value='$cfromw' />
                        <input type="hidden" name="ctow" value='$ctow' />
                        <input type="hidden" name="csortfn" value='$csortfn' />

                        $_("Page")
                        <input type="text" name="collpage" value="$collpage" size="4" />
                    </div>

                    #if not $lastpage
                    <div class="bonito-pagination-right">
                        <a href="$allhref;collpage=$(int($collpage) + 1)" id="$navid"><img class="over-img" src="../files/img/next-page.png" alt="$_("Next >")" title="$_("Next >")" data-alt-img="../files/img/next-page_s.png" /></a>
                    </div>
                    #else
                    <a id="$navid"></a>
                    #end if
                </fieldset>
            </form>
        </div>
    #end if
    #end block

    <p><strong>$_('Total'):</strong> $Total ($TotalPages $_('pages'))</p>
    <table class="data">
    #set $rowNum = 1
      <tr><th></th><th></th>
      #for $h in $Head
        <th
        #if $h.has_key('style')
          $h.style
        #end if
        #if $h.has_key('s')
          #set $hs = $h.s
        #else
          #set $hs = ''
        #end if
        ><a href='collx?$q;$globals;cattr=$cattr;cbgrfns=$cbgrfns;cminfreq=$cminfreq;cminbgr=$cminbgr;cfromw=$cfromw;ctow=$ctow;csortfn=$hs'>#if $h.n #$_($h.n)#else# #end if#</a>
        </th>
      #end for
      </tr>
      #for $i in $Items
        <tr>
            <td style="text-align: right">$($rowNum +  ($collpage - 1) * $fmaxitems).</td>
        #set $rowNum += 1
          <td><a href='view?$globals;$q;$i.pfilter'>p</a>/<a href='view?$globals;$q;$i.nfilter'>n</a></td>
          <td class='left monospace'>$i.str</td><td class="num"> $i.freq</td>
          #for $s in $i.Stats
            <td class="num"> $s.s</td>
          #end for
        </tr>
      #end for
    </table>
    #end filter

    #filter None
    $collx_navigation("next2")
    #end filter

</section>
#end def
