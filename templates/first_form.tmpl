#*
Copyright (c) 2003-2009  Pavel Rychly

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; version 2
dated June, 1991.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
*#

#encoding UTF-8
#from translation import ugettext as _
#from cmpltmpl.util.query import query
#extends query

#def title
$_("Concordance - First query form")#slurp
#end def

#def bodyonload
require(['${client_model_dir}/${page_model}', 'conf'], function (firstForm, conf) {
    conf.labelStdQuery = '$_("Std. Query")';
    conf.labelErrorQuery = '$_("Error Query")';
    conf.messages.too_long_condition = '$_('The selection condition you have specified is too long. Please create a subcorpus instead.')';
    conf.messages.cancel = '$_("Cancel")';
    conf.messages.open_the_subcorpus_form = '$_("Open the subcorpus form")';
    conf.messages.click_to_expand = '$_('Click to expand')';
    conf.messages.click_to_hide = '$_('Click to hide')';
    firstForm.init(conf);
    #if $getVar('show_cup_menu', '')
        firstForm.showCupMenu(conf);
    #end if
});
#end def

#def left_submenu_help
#end def



#def left_submenu_expert
    #if $varExists('user_menu') and $supports_password_change
    <li>
        <hr />
        <strong>$_('User'):</strong>
        <ul class="submenu">
            <li><a href="user_password_form">$_('Password change')</a></li>
        </ul>
    </li>
    #end if
#end def

#def main
#filter WebSafe
<section>
    <h2>$_('Search in the corpus')</h2>
    <form id="mainform" action="first">
    #if $shuffle
        <input type="hidden" name="shuffle" value="1" />
    #end if
    <table class="form">
    #filter None
      $corp_sel_node
      $query_node
    </table>
    #if $getVar('show_cup_menu', '')
        $cup_err_menu
    #end if

    #end filter
    #if $corp_doc
      <table><tr><td><a href="$corp_doc" target="blank">corpus documentation</a></td></tr></table>
    #end if

    #filter None
    #if $Aligned
    <fieldset class="parallel">
        <legend>$_('Aligned corpora')</legend>

        #set $sel_aln = $align.split(',')
        #for $a in $Aligned
        <div id="qnode_$a.n" class="parallel-corp-lang" style="display: none">
            <div class="heading">
                <a class="make-primary" data-corpus-id="$a.n" title="$_('make corpus primary')"><img class="over-img" src="../files/img/go-up.png"
                                                                               data-alt-img="../files/img/go-up_s.png"
                                                                               alt="$_('make corpus primary')"
                                                                               /></a>
                <h3>$a.label ($a.n)</h3>
                <a class="close-button" title="$_('Remove the language')"><img
                        class="over-img" src="../files/img/close-icon.png" data-alt-img="../files/img/close-icon_s.png"
                        alt="close icon" /></a>
            </div>
            <input type="hidden" name="sel_aligned" value="#if $a.n in $sel_aln#1#end if#" data-corpus="$a.n" />
            <table class="form">$query_node('_'+$a.n)</table>
        </div>
        #end for

        <div id="add-searched-lang-widget">
            <select>
                #for $a in $Aligned
                <option value="$a.n">$a.label</option>
                #end for
            </select>
            <button type="button">$_('Add')</button>
        </div>

    </fieldset>
    #end if
    #end filter

    <fieldset id="specify-context" class="inactive">
        <legend><a class="form-extension-switch" title="$_('click to expand')" data-box-id="context-box">$_("Specify context")
        <img class="status over-img" src="../files/img/expand.png" /></a></legend>
        <div class="contents">
        #if $has_lemmaattr
          <h3>$_("Lemma filter")</h3>
        #else
          <h3>$_("Word form filter")</h3>
        #end if
          <table class="form">
            <tr>
              <th align="left">$_("Window"):</th>
              <td><select name="fc_lemword_window_type">
                 <option value="left" #if $fc_lemword_window_type == 'left' then 'selected="selected"' else ''# >$_("left")</option>
                 <option value="right" #if $fc_lemword_window_type == 'right' then 'selected="selected"' else ''# >$_("right")</option>
                 <option value="both" #if $fc_lemword_window_type == 'both' then 'selected="selected"' else ''# >$_("both")</option>
               </select>
               <select name="fc_lemword_wsize">
                 <option>1</option>
                 <option>2</option>
                 <option>3</option>
                 <option>4</option>
                 <option selected="selected">5</option>
                 <option>7</option>
                 <option>10</option>
                 <option>15</option>
               </select>
               $_("tokens").
              </td>
            </tr>
            <tr>
        #if $has_lemmaattr
              <th align="left">$_("Lemma(s)"):</th>
        #else
              <th align="left">$_("Word form(s)"):</th>
        #end if
              <td>
              <input type="text" name="fc_lemword" class="fc_lemword" />
              <select name="fc_lemword_type">
                 <option value="all" #if $fc_lemword_type == 'all' then 'selected="selected"' else ''# >$_("all")</option>
                 <option value="any" #if $fc_lemword_type == 'any' then 'selected="selected"' else ''# >$_("any")</option>
                 <option value="none" #if $fc_lemword_type == 'none' then 'selected="selected"' else ''# >$_("none")</option>
               </select>
               $_("of these items").
              </td>
            </tr>
          </table>

        #if $Wposlist
          <h3>$_("PoS filter")</h3>
          <table class="form">
            <tr>
              <th align="left">$_("Window"):</th>
              <td colspan="2"><select name="fc_pos_window_type">
                 <option value="left" #if $fc_pos_window_type == 'left' then 'selected="selected"' else ''# >$_("left")</option>
                 <option value="right" #if $fc_pos_window_type == 'right' then 'selected="selected"' else ''# >$_("right")</option>
                 <option value="both" #if $fc_pos_window_type == 'both' then 'selected="selected"' else ''# >$_("both")</option>
               </select>
               <select name="fc_pos_wsize">
                 <option>1</option>
                 <option>2</option>
                 <option>3</option>
                 <option>4</option>
                 <option selected="selected">5</option>
                 <option>7</option>
                 <option>10</option>
                 <option>15</option>
               </select>
               $_("tokens").
              </td>
            </tr>
            <tr>
              <th align="left" valign="top">$_("PoS"):<br/><span class="explanation">($_("use Ctrl+click for") <br/>
        $_("multiple selection"))</span></th>
            <td><select name="fc_pos" size="4" multiple="multiple" title="$_("Select one or more PoS tags")">
            #for $w in $Wposlist
              <option>$_($w.n)</option>
            #end for
              </select>
            </td>
            <td valign="top">
              <select name="fc_pos_type">
                 <option value="all" #if $fc_pos_type == 'all' then 'selected="selected"' else ''# >$_("all")</option>
                 <option value="any" #if $fc_pos_type == 'any' then 'selected="selected"' else ''# >$_("any")</option>
                 <option value="none" #if $fc_pos_type == 'none' then 'selected="selected"' else ''# >$_("none")</option>
               </select>
               $_("of these items").
              </td>
            </tr>
          </table>
        #end if
    </div>
    </fieldset>


    <fieldset id="specify-query-metainformation" class="inactive">
      <legend><a class="form-extension-switch" title="$_('click to expand')" data-box-id="attrib-box">$_("Specify query according to the meta-information")
      <img class="status over-img" src="../files/img/expand.png" /></a></legend>

      #if $metadata_desc
      <div class="desc">
        #filter None#$metadata_desc#end filter#
      </div>
      #end if
      <div class="contents">
          <table>
              <tr>
                  <td>
                    #filter None
                    $tt_sel
                    #end filter
              </td></tr>
          </table>
      </div>
    </fieldset>

    <div class="buttons">
    <input id="make-concordance-button" class="submit default-button" type="submit" value="$_("Search")" />
    </div>
    </form>
    #end filter
</section>

#end def
