#*
Copyright (c) 2003-2009  Pavel Rychly

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; version 2
dated June, 1991.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
*#

#encoding UTF-8
#from cmpltmpl.document import document
#extends document

#def title
$_("Concordance - First query form")#slurp
#end def

#def bodyonload
require(['tpl/firstForm', 'domReady!'], function (firstForm, domReady) {
    ## conf object is defined within document.tmpl
    conf.labelStdQuery = '$_("Std. Query")';
    conf.labelErrorQuery = '$_("Error Query")';
    conf.messages.too_long_condition = '$_('The selection condition you have specified is too long. Please create a subcorpus instead.')';
    conf.messages.cancel = '$_("Cancel")';
    conf.messages.open_the_subcorpus_form = '$_("Open the subcorpus form")';
    firstForm.init(conf);
    #if $getVar('show_cup_menu', '')
        firstForm.showCupMenu(conf);
    #end if
});
#end def

#def left_submenu_help
#end def

#def left_submenu_expert
  <li><strong>$_("Expert options"):</strong>
    <ul class="submenu">
      <li><a class="toggle-submenu-item" data-id-to-set="contextel">$_("Context")</a>
      #if $varExists('helpsite')
        <a href="${helpsite}ConcordanceQuery#ExpertOptions" rel="help" target="_blank" title='$_("? Help on Context")'>
          <img src="$files_path/img/help.png" alt='$_("? Help on Expert options")' />
        </a>
      #end if
      </li>
      <li><a class="toggle-submenu-item" data-id-to-set="texttypeel">$_("Subcorpus")</a>
      #if $varExists('helpsite')
        <a href="${helpsite}ConcordanceQuery#ExpertOptions" rel="help" target="_blank" title='$_("? Help on Text Types")'>
          <img src="$files_path/img/help.png" alt='$_("? Help on Expert options")' />
        </a>
      #end if
      </li>
      #if $getVar('show_cup_menu', '')
      <li><a id="switch_err_stand">$_("Std. Query")</a>
         #if $varExists('helpsite')
           <a href="${helpsite}ConcordanceErrorQuery" rel="help" target="_blank" title='$_("? Help on Error Query")'>
             <img src="$files_path/img/help.png" alt='$_("? Help on Error Query")' />
            </a>
         #end if
        </li>
      #end if
    </ul>
  </li>
    #if $varExists('user_menu')
    <li>
        <hr />
        <strong>$_('User'):</strong>
        <ul class="submenu">
            <li><a href="user_password_form">$_('Password change')</a></li>
        </ul>
    </li>
    #end if
#end def

#def main

#filter WebSafe
<form id="mainform" action="first">
#if $shuffle
    <input type="hidden" name="shuffle" value="1" />
#end if
<table class="form">
#filter None
  $corp_sel_node
  $query_node
</table>
#if $getVar('show_cup_menu', '')
    $cup_err_menu
#end if
## script for hiding/showing parallel query nodes
#if $Aligned
  <fieldset class="parallel">
  <legend>$_('Aligned languages')</legend>
  <div id="add-searched-lang-widget">
      <button type="button">$_('Add')</button>
      $_('corpus') <select>
          #for $a in $Aligned
          <option value="$a.n">$a.label</option>
          #end for
      </select>
  </div>
  #set $sel_aln = $align.split(',')
  #for $a in $Aligned
  <div id="qnode_$a.n" class="parallel-corp-lang" style="display: none">
    <div class="heading">
        <h3>$a.label ($a.n)<a class="close-button" title="$_('Remove the language')"><img src="../files/img/close-icon.png" alt="close icon" /></a></h3>
    </div>
    <input type="hidden" name="sel_aligned" value="#if $a.n in $sel_aln#1#end if#" data-corpus="$a.n" />
    <table class="form">$query_node('_'+$a.n)</table>
  </div>
  #end for
  </fieldset>
#end if

#end filter
#if $corp_doc
  <table><tr><td><a href="$corp_doc" target="blank">corpus documentation</a></td></tr></table>
#end if

<fieldset class="advanced_options" id="contextel">
<legend>$_("Context")</legend>

#if $has_lemmaattr
  <h3>$_("Lemma filter")</h3>
#else
  <h3>$_("Word form filter")</h3>
#end if
  <table class="form">
    <tr>
      <th align="left">$_("Window"):</th>
      <td><select name="fc_lemword_window_type">
         <option value="left" #if $fc_lemword_window_type == 'left' then 'selected="selected"' else ''# >$_("left")</option>
         <option value="right" #if $fc_lemword_window_type == 'right' then 'selected="selected"' else ''# >$_("right")</option>
         <option value="both" #if $fc_lemword_window_type == 'both' then 'selected="selected"' else ''# >$_("both")</option>
       </select>
       <select name="fc_lemword_wsize">
         <option>1</option>
         <option>2</option>
         <option>3</option>
         <option>4</option>
         <option selected="selected">5</option>
         <option>7</option>
         <option>10</option>
         <option>15</option>
       </select>
       $_("tokens").
      </td>
    </tr>
    <tr>
#if $has_lemmaattr
      <th align="left">$_("Lemma(s)"):</th>
#else
      <th align="left">$_("Word form(s)"):</th>
#end if
      <td>
      <input type="text" name="fc_lemword" class="fc_lemword" />
      <select name="fc_lemword_type">
         <option value="all" #if $fc_lemword_type == 'all' then 'selected="selected"' else ''# >$_("all")</option>
         <option value="any" #if $fc_lemword_type == 'any' then 'selected="selected"' else ''# >$_("any")</option>
         <option value="none" #if $fc_lemword_type == 'none' then 'selected="selected"' else ''# >$_("none")</option>
       </select>
       $_("of these items").
      </td>
    </tr>
  </table>

#if $Wposlist
  <h3>$_("PoS filter")</h3>
  <table class="form">
    <tr>
      <th align="left">$_("Window"):</th>
      <td colspan="2"><select name="fc_pos_window_type">
         <option value="left" #if $fc_pos_window_type == 'left' then 'selected="selected"' else ''# >$_("left")</option>
         <option value="right" #if $fc_pos_window_type == 'right' then 'selected="selected"' else ''# >$_("right")</option>
         <option value="both" #if $fc_pos_window_type == 'both' then 'selected="selected"' else ''# >$_("both")</option>
       </select>
       <select name="fc_pos_wsize">
         <option>1</option>
         <option>2</option>
         <option>3</option>
         <option>4</option>
         <option selected="selected">5</option>
         <option>7</option>
         <option>10</option>
         <option>15</option>
       </select>
       $_("tokens").
      </td>
    </tr>
    <tr>
      <th align="left" valign="top">$_("PoS"):<br/><span class="explanation">($_("use Ctrl+click for") <br/>
$_("multiple selection"))</span></th>
    <td><select name="fc_pos" size="4" multiple="multiple" title="$_("Select one or more PoS tags")">
    #for $w in $Wposlist
      <option>$_($w.n)</option>
    #end for
      </select>
    </td>
    <td valign="top">
      <select name="fc_pos_type">
         <option value="all" #if $fc_pos_type == 'all' then 'selected="selected"' else ''# >$_("all")</option>
         <option value="any" #if $fc_pos_type == 'any' then 'selected="selected"' else ''# >$_("any")</option>
         <option value="none" #if $fc_pos_type == 'none' then 'selected="selected"' else ''# >$_("none")</option>
       </select>
       $_("of these items").
      </td>
    </tr>
  </table>
#end if
</fieldset>

#if $TextTypeSel
  <fieldset class="advanced_options" id="texttypeel">
  <legend>$_("Subcorpus")</legend>

  <table><tr>
  <th>
  $_("Available subcorpora"):
  #filter None
  $subcorp_sel
  #end filter
  </th></tr>
<tr><td>

#filter None
$tt_sel
#end filter

</td></tr>
</table>
</fieldset>
#end if

<div class="buttons">
<input id="make-concordance-button" class="submit" type="submit" value="$_("Make Concordance")" />
<input id="conc-form-clear-button" class="button" type="button" value="$_("Clear All")" />
</div>
</form>
#end filter
#end def
