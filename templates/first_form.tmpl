#from cmpltmpl.leftmenu import leftmenu
#extends leftmenu

#def title
$_("Concordance - First query form")#slurp
#end def

#attr $focus = "cmdGetFocusedId()"

#def bodyonload
cmdSwitchQuery();loadHideElementStoreSimple();loadHideElementStore('${files_path}');#slurp
#end def

#def headers
#filter WebSafe
<script src="$files_path/js/util.js" type="text/javascript"></script>
<script src="$files_path/js/effects.js" type="text/javascript"></script>
<script src="$files_path/js/controls.js" type="text/javascript"></script>
<script type="text/javascript">
document.observe("dom:loaded", function() {
    var updForm = function (item) {
        var formAncestor,
            i,
            srch,
            ancestors = item.currentTarget.ancestors();
        for (i = 0; i < ancestors.length; i += 1) {
            if (ancestors[i].nodeName === 'FORM') {
                formAncestor = ancestors[i];
                break;
            }
        }
        if (formAncestor !== undefined) {
            srch = formAncestor.select('*[name="reload"]');
            if (srch.length > 0) {
                srch[0].writeAttribute('value', '1');
            }
            srch = formAncestor.select('*[name="usesubcorp"]');
            if (srch.length > 0) {
                srch[0].writeAttribute('value', '');
            }
            formAncestor.submit();
        }
    }
    createTreeComponent(\$\$('form[action="first"] select[name="corpname"]'), null, updForm);
});
</script>
#end filter
#end def

#def left_submenu_help
  #if $varExists('helpsite')
  <li class="context_help"><a href="${helpsite}ConcordanceQuery" rel="help">$_("? Help on Expert Options")</a></li>
  #end if
#end def

#def left_submenu_expert
  <li>$_("Expert options"):
    <ul class="submenu">
      <li><a onclick="cmdHideElementStoreSimple('contextel', 1);">$_("Context")</a></li>
      <li><a onclick="cmdHideElementStoreSimple('texttypeel', 1);" >$_("Text Types")</a></li>
    </ul>
  </li>
#end def


#def main
#filter WebSafe
<form id="mainform" action="first">
<fieldset>
<table class="form">
#filter None
$corp_sel_node
$query_node
#end filter
</table>
#set $showhiddenlistsimple = $getVar("showhidsim", '').split(".")
#set $hidden = ('contextel' in $showhiddenlistsimple) and ' visible' or ' hidden'

<div class="advanced_options$hidden" id="contextel">
<h3>$_("Context")</h3>

<div class="indent">
#if $has_lemmaattr
  <h4>$_("Lemma filter")</h4>
#else
  <h4>$_("Word form filter")</h4>
#end if
  <div class="indent">
  <table class="form">
    <tr>
      <th align="left">$_("Window"):</th>
      <td><select name="fc_lemword_window_type">
         <option value="left" #if $fc_lemword_window_type == 'left' then 'selected="selected"' else ''# >$_("left")</option>
         <option value="right" #if $fc_lemword_window_type == 'right' then 'selected="selected"' else ''# >$_("right")</option>
         <option value="both" #if $fc_lemword_window_type == 'both' then 'selected="selected"' else ''# >$_("both")</option>
       </select>
       <select name="fc_lemword_wsize">
         <option>1</option>
         <option>2</option>
         <option>3</option>
         <option>4</option>
         <option selected="selected">5</option>
         <option>7</option>
         <option>10</option>
         <option>15</option>
       </select>
       $_("tokens").
      </td>
    </tr>
    <tr>
#if $has_lemmaattr
      <th align="left">$_("Lemma(s)"):</th>
#else
      <th align="left">$_("Word form(s)"):</th>
#end if
      <td>
      <input type="text" name="fc_lemword" />
      <select name="fc_lemword_type">
         <option value="all" #if $fc_lemword_type == 'all' then 'selected="selected"' else ''# >$_("all")</option>
         <option value="any" #if $fc_lemword_type == 'any' then 'selected="selected"' else ''# >$_("any")</option>
         <option value="none" #if $fc_lemword_type == 'none' then 'selected="selected"' else ''# >$_("none")</option>
       </select>
       $_("of these items").
      </td>
    </tr>
  </table>
  </div>

#if $Wposlist
  <h4>$_("PoS filter")</h4>
  <div class="indent">
  <table class="form">
    <tr>
      <th align="left">$_("Window"):</th>
      <td colspan="2"><select name="fc_pos_window_type">
         <option value="left" #if $fc_pos_window_type == 'left' then 'selected="selected"' else ''# >$_("left")</option>
         <option value="right" #if $fc_pos_window_type == 'right' then 'selected="selected"' else ''# >$_("right")</option>
         <option value="both" #if $fc_pos_window_type == 'both' then 'selected="selected"' else ''# >$_("both")</option>
       </select>
       <select name="fc_pos_wsize">
         <option>1</option>
         <option>2</option>
         <option>3</option>
         <option>4</option>
         <option selected="selected">5</option>
         <option>7</option>
         <option>10</option>
         <option>15</option>
       </select>
       $_("tokens").
      </td>
    </tr>
    <tr>
      <th align="left" valign="top">$_("PoS"):<br/><span class="explanation">($_("use Ctrl+click for") <br/>
$_("multiple selection"))</span></th>
    <td><select name="fc_pos" size="4" multiple="multiple" title="$_("Select one or more PoS tags")">
    #for $w in $Wposlist
      <option>$_($w['n'])</option>
    #end for
      </select>
    </td>
    <td valign="top">
      <select name="fc_pos_type">
         <option value="all" #if $fc_pos_type == 'all' then 'selected="selected"' else ''# >$_("all")</option>
         <option value="any" #if $fc_pos_type == 'any' then 'selected="selected"' else ''# >$_("any")</option>
         <option value="none" #if $fc_pos_type == 'none' then 'selected="selected"' else ''# >$_("none")</option>
       </select>
       $_("of these items").
      </td>
    </tr>
  </table>
  </div>
#end if
</div>
</div>


#if $TextTypeSel
  #set $hidden = ('texttypeel' in $showhiddenlistsimple) and ' visible' or ' hidden'
  <div class="advanced_options$hidden" id="texttypeel">
  <h3>$_("Text Types")</h3>

  <div class="indent">
  <table><tr>
  <th>
  $_("Subcorpus"):
  #filter None
  $subcorp_sel
  #end filter
  </th></tr>
<tr><td>

#filter None
$tt_sel
#end filter

</td></tr>
</table>
</div>
</div>
#end if

<div class="buttons">
<input class="submit" type="submit" value="$_("Make Concordance")" />
<input class="button" type="button" value="$_("Clear All")" onclick="clearForm(document.getElementById('mainform'));cmdSwitchQuery();" />
</div>
</fieldset>
</form>
#end filter
#end def
